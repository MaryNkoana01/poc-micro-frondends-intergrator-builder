{"version":3,"file":"index.js","sourceRoot":"","sources":["../../src/index.ts"],"names":[],"mappings":";;;AAqBA,KAAK,UAAU,aAAa;IAC1B,6EAA6E;IAC7E,uEAAuE;IACvE,wEAAwE;IACxE,WAAW;IACX,MAAM,wBAAwB,CAAC,SAAS,CAAC,CAAC;IAE1C,MAAM,SAAS,GAAG,MAAM,CAAC,4CAA4C,CAAC;IAEtE,IAAI,CAAC,SAAS,EAAE;QACd,MAAM,IAAI,KAAK,CACb,gGAAgG,CACjG,CAAC;KACH;IAED,MAAM,CAAC,4CAA4C,GAAG,SAAS,CAAC;IAEhE,MAAM,SAAS,CAAC,IAAI,CAAC,wBAAwB,CAAC,OAAO,CAAC,CAAC;IAEvD,8EAA8E;IAC9E,mCAAmC;IACnC,MAAM,OAAO,GAAG,MAAM,SAAS,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC;IACxD,MAAM,MAAM,GAAG,OAAO,EAAE,CAAC;IAEzB,OAAO,MAAM,CAAC;AAChB,CAAC;AAED;;;;;GAKG;AACI,KAAK,UAAU,mBAAmB,CAAC,GAAW;IACnD,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;QACrC,MAAM,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;QAEjD,OAAO,CAAC,GAAG,GAAG,GAAG,CAAC;QAClB,OAAO,CAAC,IAAI,GAAG,iBAAiB,CAAC;QACjC,OAAO,CAAC,KAAK,GAAG,IAAI,CAAC;QAErB,OAAO,CAAC,MAAM,GAAG,GAAG,EAAE;YACpB,aAAa,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;YAC5C,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;QACrC,CAAC,CAAC;QAEF,OAAO,CAAC,OAAO,GAAG,GAAG,EAAE;YACrB,MAAM,CAAC,IAAI,KAAK,CAAC,kCAAkC,CAAC,CAAC,CAAC;YACtD,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;QACrC,CAAC,CAAC;QAEF,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;IACrC,CAAC,CAAC,CAAC;AACL,CAAC;AApBD,kDAoBC","sourcesContent":["interface GlobalScope {\n  get: (module: string) => Promise<() => unknown>;\n  init: (sharedModules: SharedModules) => Promise<void>;\n}\n\ndeclare global {\n  interface Window {\n    __feature_hub_feature_app_module_container__: GlobalScope | undefined;\n  }\n}\n\n// Will be replaced by Webpack with a custom property of __webpack_require__.\ndeclare const __webpack_init_sharing__: (name: string) => Promise<void>;\n\n// Will be replaced by Webpack with a custom property of __webpack_require__.\ndeclare const __webpack_share_scopes__: {\n  default: SharedModules;\n};\n\ntype SharedModules = unknown;\n\nasync function loadComponent(): Promise<unknown> {\n  // Initializing the default share scope is needed, in case the integrator has\n  // not declared any shared modules. If it has declared a shared module,\n  // __webpack_init_sharing__ will return early without executing any side\n  // effects.\n  await __webpack_init_sharing__('default');\n\n  const container = window.__feature_hub_feature_app_module_container__;\n\n  if (!container) {\n    throw new Error(\n      `The name in the ModuleFederationPlugin must be \"__feature_hub_feature_app_module_container__\".`,\n    );\n  }\n\n  window.__feature_hub_feature_app_module_container__ = undefined;\n\n  await container.init(__webpack_share_scopes__.default);\n\n  // The container.get call will be rejected when the module can not be found in\n  // the module map of the container.\n  const factory = await container.get('featureAppModule');\n  const Module = factory();\n\n  return Module;\n}\n\n/**\n * @param url A URL pointing to a bundle that was built as a federated module.\n *\n * @returns A promise that resolves with the loaded module, or is rejected if\n * the module can not be loaded.\n */\nexport async function loadFederatedModule(url: string): Promise<unknown> {\n  return new Promise((resolve, reject) => {\n    const element = document.createElement('script');\n\n    element.src = url;\n    element.type = 'text/javascript';\n    element.async = true;\n\n    element.onload = () => {\n      loadComponent().then(resolve).catch(reject);\n      document.head.removeChild(element);\n    };\n\n    element.onerror = () => {\n      reject(new Error('Could not load federated module.'));\n      document.head.removeChild(element);\n    };\n\n    document.head.appendChild(element);\n  });\n}\n"]}