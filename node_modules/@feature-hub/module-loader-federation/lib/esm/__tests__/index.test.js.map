{"version":3,"file":"index.test.js","sourceRoot":"","sources":["../../../src/__tests__/index.test.ts"],"names":[],"mappings":"AAAA;;GAEG;AAEH,OAAO,EAAC,mBAAmB,EAAC,MAAM,IAAI,CAAC;AASvC,QAAQ,CAAC,+CAA+C,EAAE,GAAG,EAAE;IAC7D,UAAU,CAAC,GAAG,EAAE;QACd,MAAM,CAAC,wBAAwB,GAAG,IAAI,CAAC,EAAE,EAAE,CAAC;QAC5C,MAAM,CAAC,wBAAwB,GAAG,EAAC,OAAO,EAAE,EAAE,EAAC,CAAC;IAClD,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,uEAAuE,EAAE,KAAK,IAAI,EAAE;QACrF,MAAM,gBAAgB,GAAG,EAAE,CAAC;QAC5B,MAAM,aAAa,GAAG,mBAAmB,CAAC,gBAAgB,CAAC,CAAC;QAC5D,MAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,aAAa,CAAC,CAAC;QAErD,MAAM,CAAC,4CAA4C,GAAG;YACpD,IAAI,EAAE,IAAI,CAAC,EAAE,EAAE;YACf,GAAG,EAAE,GAAG,EAAE,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC,gBAAgB,CAAC;SACnD,CAAC;QAEF,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,aAAa,CAAC,IAAI,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;QAEzC,MAAM,MAAM,GAAG,MAAM,aAAa,CAAC;QACnC,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,gBAAgB,CAAC,CAAC;IAC3C,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,0CAA0C,EAAE,KAAK,IAAI,EAAE;QACxD,MAAM,aAAa,GAAG,mBAAmB,CAAC,gBAAgB,CAAC,CAAC;QAC5D,MAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,aAAa,CAAC,CAAC;QAErD,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,aAAa,CAAC,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC;QAE1C,OAAO,MAAM,CAAC,aAAa,CAAC,CAAC,OAAO,CAAC,YAAY,EAAE,CAAC;IACtD,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,0EAA0E,EAAE,KAAK,IAAI,EAAE;QACxF,MAAM,GAAG,GAAG,eAAe,CAAC;QAC5B,MAAM,aAAa,GAAG,mBAAmB,CAAC,GAAG,CAAC,CAAC;QAC/C,MAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,aAAa,CAAC,CAAC;QAErD,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,aAAa,CAAC,IAAI,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;QAEzC,OAAO,MAAM,CAAC,aAAa,CAAC,CAAC,OAAO,CAAC,YAAY,EAAE,CAAC;IACtD,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["/**\n * @jest-environment jsdom\n */\n\nimport {loadFederatedModule} from '..';\n\ndeclare global {\n  interface Window {\n    __webpack_init_sharing__: (name: string) => Promise<void>;\n    __webpack_share_scopes__: {default: {}};\n  }\n}\n\ndescribe('load featureapp via webpack module federation', () => {\n  beforeEach(() => {\n    window.__webpack_init_sharing__ = jest.fn();\n    window.__webpack_share_scopes__ = {default: {}};\n  });\n\n  it('returns the feature app module when the module is loaded successfully', async () => {\n    const featureAppModule = {};\n    const modulePromise = loadFederatedModule('feature-app.js');\n    const script = document.querySelector('head script');\n\n    window.__feature_hub_feature_app_module_container__ = {\n      init: jest.fn(),\n      get: () => Promise.resolve(() => featureAppModule),\n    };\n\n    script?.dispatchEvent(new Event('load'));\n\n    const module = await modulePromise;\n    expect(module).toEqual(featureAppModule);\n  });\n\n  it('rejects when the module cannot be loaded', async () => {\n    const modulePromise = loadFederatedModule('feature-app.js');\n    const script = document.querySelector('head script');\n\n    script?.dispatchEvent(new Event('error'));\n\n    return expect(modulePromise).rejects.toThrowError();\n  });\n\n  it('rejects when __feature_hub_feature_app_module_container__ is not defined', async () => {\n    const url = 'featureapp.js';\n    const modulePromise = loadFederatedModule(url);\n    const script = document.querySelector('head script');\n\n    script?.dispatchEvent(new Event('load'));\n\n    return expect(modulePromise).rejects.toThrowError();\n  });\n});\n"]}