{"version":3,"file":"index.test.js","sourceRoot":"","sources":["../../../src/__tests__/index.test.ts"],"names":[],"mappings":"AAAA,uCAAuC;AAOvC,OAAO,EAAuC,mBAAmB,EAAC,MAAM,IAAI,CAAC;AAE7E,QAAQ,CAAC,qBAAqB,EAAE,GAAG,EAAE;IACnC,IAAI,OAAsC,CAAC;IAC3C,IAAI,uBAA8E,CAAC;IACnF,IAAI,aAA8B,CAAC;IAEnC,UAAU,CAAC,GAAG,EAAE;QACd,OAAO,GAAG,EAAC,eAAe,EAAE,EAAE,EAAC,CAAC;QAEhC,aAAa,GAAG;YACd,GAAG,EAAE,MAAM;YACX,OAAO,EAAE,EAAE;YACX,OAAO,EAAE,EAAE;SACZ,CAAC;QAEF,uBAAuB,GAAG,mBAAmB,CAAC,aAAa,CAAC,CAAC;IAC/D,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,qCAAqC,EAAE,GAAG,EAAE;QAC7C,MAAM,CAAC,uBAAuB,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC;QAC7D,MAAM,CAAC,uBAAuB,CAAC,YAAY,CAAC,CAAC,aAAa,EAAE,CAAC;IAC/D,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,SAAS,EAAE,GAAG,EAAE;QACvB,EAAE,CAAC,2DAA2D,EAAE,GAAG,EAAE;YACnE,MAAM,mBAAmB,GAAG,uBAAuB,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;YAEpE,MAAM,CAAC,mBAAoB,CAAC,OAAO,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC;QACtD,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,iBAAiB,EAAE,GAAG,EAAE;QAC/B,IAAI,mBAA0D,CAAC;QAE/D,UAAU,CAAC,GAAG,EAAE;YACd,mBAAmB,GAAG,uBAAuB,CAAC,MAAM,CAAC,OAAO,CAAE,CAAC,OAAO,CAAC,CAAC;QAC1E,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,kCAAkC,EAAE,GAAG,EAAE;YAC1C,MAAM,EAAC,cAAc,EAAC,GAAG,mBAAmB,CAAC,QAAQ,CAAC,CAAC;YAEvD,MAAM,CAAC,cAAc,CAAC,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC;QAChD,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["// tslint:disable:no-non-null-assertion\n\nimport {\n  FeatureServiceBinder,\n  FeatureServiceEnvironment,\n  FeatureServiceProviderDefinition,\n} from '@feature-hub/core';\nimport {ServerRequestV1, SharedServerRequest, defineServerRequest} from '..';\n\ndescribe('defineServerRequest', () => {\n  let mockEnv: FeatureServiceEnvironment<{}>;\n  let serverRequestDefinition: FeatureServiceProviderDefinition<SharedServerRequest>;\n  let serverRequest: ServerRequestV1;\n\n  beforeEach(() => {\n    mockEnv = {featureServices: {}};\n\n    serverRequest = {\n      url: '/app',\n      cookies: {},\n      headers: {},\n    };\n\n    serverRequestDefinition = defineServerRequest(serverRequest);\n  });\n\n  it('creates a Server Request definition', () => {\n    expect(serverRequestDefinition.id).toBe('s2:server-request');\n    expect(serverRequestDefinition.dependencies).toBeUndefined();\n  });\n\n  describe('#create', () => {\n    it('creates a shared Feature Service containing version 1.0.0', () => {\n      const sharedServerRequest = serverRequestDefinition.create(mockEnv);\n\n      expect(sharedServerRequest!['1.0.0']).toBeDefined();\n    });\n  });\n\n  describe('ServerRequestV1', () => {\n    let serverRequestBinder: FeatureServiceBinder<ServerRequestV1>;\n\n    beforeEach(() => {\n      serverRequestBinder = serverRequestDefinition.create(mockEnv)!['1.0.0'];\n    });\n\n    it('equals the defined serverRequest', () => {\n      const {featureService} = serverRequestBinder('test:1');\n\n      expect(featureService).toEqual(serverRequest);\n    });\n  });\n});\n"]}